
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../raman_spectrometer_controller_PI_trial/">
      
      
        <link rel="next" href="../raman_spectrometer_controller_WasatchEnlighten/">
      
      
        
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>raman_spectrometer_controller_QEPro - ORM-IRIS Library Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#iris.controllers.raman_spectrometer_controller_QEPro" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="ORM-IRIS Library Documentation" class="md-header__button md-logo" aria-label="ORM-IRIS Library Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ORM-IRIS Library Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              raman_spectrometer_controller_QEPro
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="ORM-IRIS Library Documentation" class="md-nav__button md-logo" aria-label="ORM-IRIS Library Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    ORM-IRIS Library Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    iris
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    iris
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1_1" id="__nav_2_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    calibration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    calibration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../calibration/calibration_generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    calibration_generator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../calibration/test_calibrator_wavelength/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    test_calibrator_wavelength
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1_2" id="__nav_2_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    controllers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    controllers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../camera_controller_dummy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    camera_controller_dummy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../camera_controller_thorlabs_color/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    camera_controller_thorlabs_color
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../camera_controller_thorlabs_mono/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    camera_controller_thorlabs_mono
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../camera_controller_webcam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    camera_controller_webcam
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../class_camera_controller/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    class_camera_controller
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../class_spectrometer_controller/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    class_spectrometer_controller
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../class_xy_stage_controller/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    class_xy_stage_controller
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../class_z_stage_controller/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    class_z_stage_controller
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mcm301_wrapper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    mcm301_wrapper
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../oceandirect_wrapper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    oceandirect_wrapper
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../raman_spectrometer_controller_Andor_dll/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    raman_spectrometer_controller_Andor_dll
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../raman_spectrometer_controller_Andor_pylablib/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    raman_spectrometer_controller_Andor_pylablib
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../raman_spectrometer_controller_PI_dll/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    raman_spectrometer_controller_PI_dll
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../raman_spectrometer_controller_PI_pylablib/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    raman_spectrometer_controller_PI_pylablib
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../raman_spectrometer_controller_PI_trial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    raman_spectrometer_controller_PI_trial
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    raman_spectrometer_controller_QEPro
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    raman_spectrometer_controller_QEPro
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro" class="md-nav__link">
    <span class="md-ellipsis">
      
        raman_spectrometer_controller_QEPro
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro" class="md-nav__link">
    <span class="md-ellipsis">
      
        SpectrometerController_QEPro
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SpectrometerController_QEPro">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.get_identifier" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_identifier
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.get_integration_time_limits_us" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_integration_time_limits_us
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.get_integration_time_us" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_integration_time_us
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.initialisation" class="md-nav__link">
    <span class="md-ellipsis">
      
        initialisation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.measure_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      
        measure_spectrum
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.self_test_get_spec_formatted" class="md-nav__link">
    <span class="md-ellipsis">
      
        self_test_get_spec_formatted
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.set_integration_time_us" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_integration_time_us
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.terminate" class="md-nav__link">
    <span class="md-ellipsis">
      
        terminate
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.check_and_create_config_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_and_create_config_file
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.convert_ramanshift_to_wavelength" class="md-nav__link">
    <span class="md-ellipsis">
      
        convert_ramanshift_to_wavelength
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.convert_timestamp_us_int_to_str" class="md-nav__link">
    <span class="md-ellipsis">
      
        convert_timestamp_us_int_to_str
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.convert_timestamp_us_str_to_int" class="md-nav__link">
    <span class="md-ellipsis">
      
        convert_timestamp_us_str_to_int
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.convert_wavelength_to_ramanshift" class="md-nav__link">
    <span class="md-ellipsis">
      
        convert_wavelength_to_ramanshift
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.generate_test_app" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_test_app
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.get_all_widgets" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_all_widgets
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.get_all_widgets_from_layout" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_all_widgets_from_layout
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.get_timestamp_day" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_timestamp_day
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.get_timestamp_sec" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_timestamp_sec
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.get_timestamp_us_int" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_timestamp_us_int
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.get_timestamp_us_str" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_timestamp_us_str
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.messagebox_request_input" class="md-nav__link">
    <span class="md-ellipsis">
      
        messagebox_request_input
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.read_update_config_file_section" class="md-nav__link">
    <span class="md-ellipsis">
      
        read_update_config_file_section
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.run_with_timeout" class="md-nav__link">
    <span class="md-ellipsis">
      
        run_with_timeout
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.validator_float_greaterThanZero" class="md-nav__link">
    <span class="md-ellipsis">
      
        validator_float_greaterThanZero
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../raman_spectrometer_controller_WasatchEnlighten/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    raman_spectrometer_controller_WasatchEnlighten
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../raman_spectrometer_controller_dummy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    raman_spectrometer_controller_dummy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xy_stage_controller_PI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    xy_stage_controller_PI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xy_stage_controller_PI_dll/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    xy_stage_controller_PI_dll
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xy_stage_controller_dummy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    xy_stage_controller_dummy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xy_stage_controller_m30xy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    xy_stage_controller_m30xy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xy_stage_controller_zaber/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    xy_stage_controller_zaber
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../z_stage_controller_dummy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    z_stage_controller_dummy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../z_stage_controller_mcm301/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    z_stage_controller_mcm301
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../z_stage_controller_pfm450/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    z_stage_controller_pfm450
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../z_stage_controller_z825b/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    z_stage_controller_z825b
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_3" >
        
          
          <label class="md-nav__link" for="__nav_2_1_3" id="__nav_2_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    data
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    data
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/calibration_objective/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    calibration_objective
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/measurement_Raman/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    measurement_Raman
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/measurement_RamanMap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    measurement_RamanMap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/measurement_coordinates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    measurement_coordinates
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/measurement_image/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    measurement_image
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_4" >
        
          
          <label class="md-nav__link" for="__nav_2_1_4" id="__nav_2_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    gui
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    gui
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/dataHub_MeaImg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dataHub_MeaImg
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/dataHub_MeaRMap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dataHub_MeaRMap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/hilvl_Brightfield/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hilvl_Brightfield
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/hilvl_Raman/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hilvl_Raman
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/hilvl_coorGen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hilvl_coorGen
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_4_6" >
        
          
          <label class="md-nav__link" for="__nav_2_1_4_6" id="__nav_2_1_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    image_calibration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_4_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    image_calibration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/image_calibration/Canvas_ROIdefinition/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Canvas_ROIdefinition
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/image_calibration/objective_calibration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    objective_calibration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/image_calibration/plotter_heatmap_overlay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    plotter_heatmap_overlay
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/motion_video/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    motion_video
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/raman/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    raman
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/shortcut_handler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    shortcut_handler
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_4_10" >
        
          
          <label class="md-nav__link" for="__nav_2_1_4_10" id="__nav_2_1_4_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    submodules
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_4_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    submodules
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/submodules/heatmap_plotter_MeaRMap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    heatmap_plotter_MeaRMap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/submodules/image_tiling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    image_tiling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_4_10_3" >
        
          
          <label class="md-nav__link" for="__nav_2_1_4_10_3" id="__nav_2_1_4_10_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    meaCoor_generator
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_1_4_10_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_4_10_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    meaCoor_generator
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/submodules/meaCoor_generator/line_zScan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    line_zScan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/submodules/meaCoor_generator/points_image/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    points_image
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/submodules/meaCoor_generator/rectangle_aroundCentre/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    rectangle_aroundCentre
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/submodules/meaCoor_generator/rectangle_endToEnd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    rectangle_endToEnd
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/submodules/meaCoor_generator/rectangle_image/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    rectangle_image
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/submodules/meaCoor_generator/rectangle_video/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    rectangle_video
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/submodules/meaCoor_generator/singlePoint_zScan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    singlePoint_zScan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/submodules/meaCoor_generator/ssfrm_tilemthd1_rect_around/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ssfrm_tilemthd1_rect_around
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_4_10_4" >
        
          
          <label class="md-nav__link" for="__nav_2_1_4_10_4" id="__nav_2_1_4_10_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    meaCoor_modifier
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_1_4_10_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_4_10_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    meaCoor_modifier
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/submodules/meaCoor_modifier/every_z/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    every_z
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/submodules/meaCoor_modifier/gridify/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    gridify
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/submodules/meaCoor_modifier/topology_visualiser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    topology_visualiser
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/submodules/meaCoor_modifier/translateXYZ/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    translateXYZ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/submodules/meaCoor_modifier/zInterpolate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    zInterpolate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/submodules/peakfinder_plotter_MeaRaman/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    peakfinder_plotter_MeaRaman
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui/timestamp_coorshift/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    timestamp_coorshift
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main_analyser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    main_analyser
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_6" >
        
          
          <label class="md-nav__link" for="__nav_2_1_6" id="__nav_2_1_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    multiprocessing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    multiprocessing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../multiprocessing/basemanager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    basemanager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../multiprocessing/dataStreamer_Raman/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dataStreamer_Raman
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../multiprocessing/dataStreamer_StageCam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dataStreamer_StageCam
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_7" >
        
          
          <label class="md-nav__link" for="__nav_2_1_7" id="__nav_2_1_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    resources
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    resources
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_7_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1_7_1" id="__nav_2_1_7_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    coordinate_generators
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_7_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    coordinate_generators
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/coordinate_generators/convert_2Dto3D_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    convert_2Dto3D_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/coordinate_generators/point_image_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    point_image_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/coordinate_generators/point_zScanLinear_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    point_zScanLinear_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/coordinate_generators/rect_aroundcentre_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    rect_aroundcentre_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/coordinate_generators/rect_image_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    rect_image_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/coordinate_generators/rect_startend_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    rect_startend_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/coordinate_generators/rect_video_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    rect_video_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_7_2" >
        
          
          <label class="md-nav__link" for="__nav_2_1_7_2" id="__nav_2_1_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    coordinate_modifiers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_7_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    coordinate_modifiers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/coordinate_modifiers/every_z_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    every_z_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/coordinate_modifiers/gridify_setup_finetuning_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    gridify_setup_finetuning_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/coordinate_modifiers/gridify_setup_naming_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    gridify_setup_naming_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/coordinate_modifiers/gridify_setup_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    gridify_setup_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/coordinate_modifiers/topology_visuliser_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    topology_visuliser_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/coordinate_modifiers/translator_xyz_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    translator_xyz_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/coordinate_modifiers/zInterpolate_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    zInterpolate_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/dataHubPlus_Raman_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dataHubPlus_Raman_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/dataHub_Raman_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dataHub_Raman_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/dataHub_coor_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dataHub_coor_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/dataHub_image_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dataHub_image_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/heatmap_plotter_overlay_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    heatmap_plotter_overlay_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/heatmap_plotter_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    heatmap_plotter_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/hilvl_Raman_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hilvl_Raman_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/hilvl_brightfield_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hilvl_brightfield_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/hilvl_coorGen_coorMod_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hilvl_coorGen_coorMod_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/hilvl_coorGen_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hilvl_coorGen_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/main_analyser_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    main_analyser_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/main_controller_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    main_controller_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_7_15" >
        
          
          <label class="md-nav__link" for="__nav_2_1_7_15" id="__nav_2_1_7_15_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    motion_video
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_7_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_7_15">
            <span class="md-nav__icon md-icon"></span>
            
  
    motion_video
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/motion_video/brightfieldcontrol_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    brightfieldcontrol_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/motion_video/stagecontrol_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    stagecontrol_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/objective_calibration_controls_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    objective_calibration_controls_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/objective_calibration_main_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    objective_calibration_main_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/objectives_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    objectives_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/raman_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    raman_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/spectra_peak_finder_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    spectra_peak_finder_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/spectrometer_calibration_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    spectrometer_calibration_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/tiling_method_control_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tiling_method_control_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/tiling_method_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tiling_method_ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_8" >
        
          
          <label class="md-nav__link" for="__nav_2_1_8" id="__nav_2_1_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    utils
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/general/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    general
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/gridify/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    gridify
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro" class="md-nav__link">
    <span class="md-ellipsis">
      
        raman_spectrometer_controller_QEPro
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro" class="md-nav__link">
    <span class="md-ellipsis">
      
        SpectrometerController_QEPro
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SpectrometerController_QEPro">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.get_identifier" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_identifier
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.get_integration_time_limits_us" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_integration_time_limits_us
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.get_integration_time_us" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_integration_time_us
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.initialisation" class="md-nav__link">
    <span class="md-ellipsis">
      
        initialisation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.measure_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      
        measure_spectrum
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.self_test_get_spec_formatted" class="md-nav__link">
    <span class="md-ellipsis">
      
        self_test_get_spec_formatted
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.set_integration_time_us" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_integration_time_us
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.terminate" class="md-nav__link">
    <span class="md-ellipsis">
      
        terminate
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.check_and_create_config_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_and_create_config_file
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.convert_ramanshift_to_wavelength" class="md-nav__link">
    <span class="md-ellipsis">
      
        convert_ramanshift_to_wavelength
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.convert_timestamp_us_int_to_str" class="md-nav__link">
    <span class="md-ellipsis">
      
        convert_timestamp_us_int_to_str
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.convert_timestamp_us_str_to_int" class="md-nav__link">
    <span class="md-ellipsis">
      
        convert_timestamp_us_str_to_int
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.convert_wavelength_to_ramanshift" class="md-nav__link">
    <span class="md-ellipsis">
      
        convert_wavelength_to_ramanshift
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.generate_test_app" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_test_app
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.get_all_widgets" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_all_widgets
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.get_all_widgets_from_layout" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_all_widgets_from_layout
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.get_timestamp_day" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_timestamp_day
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.get_timestamp_sec" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_timestamp_sec
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.get_timestamp_us_int" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_timestamp_us_int
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.get_timestamp_us_str" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_timestamp_us_str
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.messagebox_request_input" class="md-nav__link">
    <span class="md-ellipsis">
      
        messagebox_request_input
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.read_update_config_file_section" class="md-nav__link">
    <span class="md-ellipsis">
      
        read_update_config_file_section
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.run_with_timeout" class="md-nav__link">
    <span class="md-ellipsis">
      
        run_with_timeout
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iris.controllers.raman_spectrometer_controller_QEPro.validator_float_greaterThanZero" class="md-nav__link">
    <span class="md-ellipsis">
      
        validator_float_greaterThanZero
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>raman_spectrometer_controller_QEPro</h1>

<div class="doc doc-object doc-module">



<a id="iris.controllers.raman_spectrometer_controller_QEPro"></a>
    <div class="doc doc-contents first">

        <p>A class that allows the control of the QE Pro spectrometer from Ocean Insight.
This implementation is based on the API provided by Ocean Insight.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro" class="doc doc-heading">
            <code>SpectrometerController_QEPro</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Class_SpectrometerController (iris.controllers.class_spectrometer_controller.Class_SpectrometerController)" href="../class_spectrometer_controller/#iris.controllers.class_spectrometer_controller.Class_SpectrometerController">Class_SpectrometerController</a></code></p>










              <details class="mkdocstrings-source">
                <summary>Source code in <code>iris/controllers/raman_spectrometer_controller_QEPro.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SpectrometerController_QEPro</span><span class="p">(</span><span class="n">Class_SpectrometerController</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Get the Ocean Direct classes from the wrapper</span>
        <span class="n">OceanDirectAPI</span><span class="p">,</span> <span class="n">OceanDirectError</span><span class="p">,</span> <span class="n">FeatureID</span> <span class="o">=</span> <span class="n">get_oceandirect_classes</span><span class="p">()</span>

        <span class="c1"># Store the classes as instance variables for use in other methods</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectAPI</span> <span class="o">=</span> <span class="n">OceanDirectAPI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="o">=</span> <span class="n">OceanDirectError</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FeatureID</span> <span class="o">=</span> <span class="n">FeatureID</span>

        <span class="c1"># Create the API instance with proper path handling</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">od</span> <span class="o">=</span> <span class="n">create_oceandirect_api</span><span class="p">()</span>                  <span class="c1"># Ocean Direct API</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dev_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">od</span><span class="o">.</span><span class="n">find_usb_devices</span><span class="p">()</span>         <span class="c1"># Device count</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dev_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">od</span><span class="o">.</span><span class="n">get_device_ids</span><span class="p">()</span>             <span class="c1"># Device IDs (if multiple)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">od</span><span class="o">.</span><span class="n">get_api_version_numbers</span><span class="p">()</span>   <span class="c1"># API info</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dev</span> <span class="o">=</span> <span class="kc">None</span>         <span class="c1"># OD API device class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dev_id</span> <span class="o">=</span> <span class="kc">None</span>      <span class="c1"># Store the device ID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dev_serial</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># device serial number</span>

        <span class="c1"># Aquisition related parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">integration_time_min</span> <span class="o">=</span> <span class="kc">None</span>        <span class="c1"># int: Stores the spectrometer&#39;s minimum allowable integration time [millisec]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">integration_time_max</span> <span class="o">=</span> <span class="kc">None</span>        <span class="c1"># int: Stores the spectrometer&#39;s maximum allowable integration time [millisec]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">integration_time_inc</span> <span class="o">=</span> <span class="kc">None</span>        <span class="c1"># int: Stores the spectrometer&#39;s allowable integration time increment [millisec]</span>

        <span class="c1"># Calibration related parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bg_acq_num</span> <span class="o">=</span> <span class="mi">10</span>    <span class="c1"># Number of aquisition for the background removal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bg_spec</span> <span class="o">=</span> <span class="kc">None</span>     <span class="c1"># The background spectrum</span>


        <span class="c1"># Lock for the device communications</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>     <span class="c1"># Lock for the acquisition process</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">:</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;discreet&#39;</span><span class="p">,</span><span class="s1">&#39;continuous&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ControllerSpecificConfigEnum</span><span class="o">.</span><span class="n">OCEANINSIGHT_MODE</span><span class="o">.</span><span class="n">value</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;discreet&#39;</span><span class="p">,</span><span class="s1">&#39;continuous&#39;</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s1">&#39;continuous&#39;</span>

        <span class="c1"># &gt;&gt;&gt; Current implementation is for the &#39;continuous&#39; mode only. The &#39;discreet&#39; mode seems to be causing some weird communication slowdowns.</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&gt;&gt;&gt;&gt;&gt; QEPro: Current mode: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: The &#39;discreet&#39; mode is NOT FULLY IMPLEMENTED yet and might cause some random SLOWDOWNS. If you experience any issues, please switch to the &#39;continuous&#39; mode.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&lt;&lt;&lt;&lt;&lt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>


        <span class="c1"># Measurement related parameters</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">==</span> <span class="s1">&#39;discreet&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_init_timestamp</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Initial timestamp of the measurement</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_offset_timestamp</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Offset timestamp of the measurement</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_mea</span> <span class="o">=</span> <span class="p">[]</span>    <span class="c1"># Temporary list to transfer measurements from the device</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_ts</span> <span class="o">=</span> <span class="p">[]</span>     <span class="c1"># Temporary list to transfer timestamps from the device</span>

        <span class="c1"># Acquisition parameters:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wavelength</span><span class="p">:</span><span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Start the initialisation process</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialisation</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the identifier of the spectrometer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The identifier of the spectrometer</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_identifier</span>

<span class="c1"># Core functionalities (initialisation, termination)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">initialisation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the Raman spectrometer controller.</span>

<span class="sd">        This function performs the following tasks:</span>
<span class="sd">        1. Prints the API info and the number of devices connected.</span>
<span class="sd">        2. Checks if any device is found. If not, it terminates the program.</span>
<span class="sd">        3. Checks if more than one device is found. If so, it terminates the program.</span>
<span class="sd">        4. Creates a device instance using the first device in the device list.</span>
<span class="sd">        5. Retrieves the serial number of the device.</span>
<span class="sd">        6. Retrieves the integration time requirements of the device.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Print the API info and the devices connected</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;API Version  : </span><span class="si">%d</span><span class="s2">.</span><span class="si">%d</span><span class="s2">.</span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_info</span><span class="p">)</span>   <span class="c1"># if this doesn&#39;t work, try (self.api_info[0],self.api_info[1],self.api_info[2])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total Device : </span><span class="si">%d</span><span class="s2">     </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev_count</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt; No device found &lt;&lt;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev_count</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt; More than 1 device is found &lt;&lt;&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The program has not been designed to handle more than 1 devices and thus will be shut down&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">terminate</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Create a device instance by taking the 1st in the device list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dev_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">od</span><span class="o">.</span><span class="n">open_device</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dev_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dev_serial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_serial_number</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First Device : </span><span class="si">%d</span><span class="s2">       &quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev_id</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Serial Number: </span><span class="si">%s</span><span class="s2">     </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev_serial</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_identifier</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Ocean Insight, device id: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dev_id</span><span class="si">}</span><span class="s2">, S/N:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dev_serial</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># Retrieve the integration time requirements of the device</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">integration_time_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_maximum_integration_time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">integration_time_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_minimum_integration_time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">integration_time_inc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_integration_time_increment</span><span class="p">()</span>

        <span class="c1"># Initialise the timestamp</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">==</span> <span class="s1">&#39;discreet&#39;</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
                <span class="n">int_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_integration_time</span><span class="p">()</span>
                <span class="n">min_int_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_minimum_integration_time</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">set_integration_time</span><span class="p">(</span><span class="n">min_int_time</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_init_timestamp</span> <span class="o">=</span> <span class="n">get_timestamp_us_int</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_mea</span><span class="o">.</span><span class="n">clear</span><span class="p">();</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_ts</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

                <span class="c1"># self.dev.Advanced.set_number_of_backtoback_scans(1)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">acquire_spectra_to_buffer</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">get_raw_spectrum_with_metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_mea</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_ts</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_offset_timestamp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_ts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">set_integration_time</span><span class="p">(</span><span class="n">int_time</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">==</span> <span class="s1">&#39;continuous&#39;</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">acquire_spectra_to_buffer</span><span class="p">()</span>

        <span class="c1"># Grab the wavelengths of the device</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_wavelengths</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">terminate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        To terminate the connections to the Raman spectrometers</span>

<span class="sd">        Args:</span>
<span class="sd">            error_flag (bool, optional): Can also passes an error message. Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">error_flag</span><span class="o">!=</span><span class="kc">False</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Error code:&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">error_flag</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dev_ids</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">od</span><span class="o">.</span><span class="n">close_device</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dev_ids</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&gt;&gt;&gt;&gt;&gt; Raman controller TERMINATED &lt;&lt;&lt;&lt;&lt;&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ocean Insight devices disconnected&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_integration_time_limits_us</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the integration time limits of the device</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple: A tuple containing the minimum, maximum, and increment of the integration time in [device unit] (microseconds for the QE Pro)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">integration_time_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">integration_time_max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">integration_time_inc</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_integration_time_us</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the integration time of the device</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Integration time in [device unit] (microseconds for the QE Pro)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="n">int_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_integration_time</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">int_time</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_integration_time_us</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">integration_time</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the integration time of the device</span>

<span class="sd">        Args:</span>
<span class="sd">            integration_time (int): Integration time in [device unit] </span>
<span class="sd">            (microseconds for the QE Pro)</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Device integrationt time after set up</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;work here (raman spectrometer controller file)&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">integration_time</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">integration_time</span><span class="p">,</span><span class="nb">float</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Integration time must be an integer&quot;</span><span class="p">)</span>
        <span class="n">integration_time</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">integration_time</span><span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">set_integration_time</span><span class="p">(</span><span class="n">integration_time</span><span class="p">)</span>
            <span class="n">int_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_integration_time</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">int_time</span>

<span class="c1"># Spectrometer acquisition control</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_acquisitionDelay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delay_value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the acquisition delay of the spectrometer.</span>
<span class="sd">        This may also be referred to as the trigger delay.</span>
<span class="sd">        In any event, it is the time between some event (such as a request for data, or an external trigger pulse) and when data acquisition begins.</span>

<span class="sd">        Q. Why is it needed?</span>
<span class="sd">        Sometimes we want to delay the acquisition so that the </span>

<span class="sd">        Args:</span>
<span class="sd">            delay_value (int): The acquisition delay to be set [us]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#device.set_acquisition_delay(120)</span>
        <span class="c1">#print(&quot;acquisitionDelay(device): set acqDelay 120&quot;)</span>
        <span class="n">device</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span>

        <span class="n">acqDelay</span>    <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">get_acquisition_delay</span><span class="p">()</span>
        <span class="n">acqDelayInc</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">get_acquisition_delay_increment</span><span class="p">()</span>
        <span class="n">acqDelayMin</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">get_acquisition_delay_minimum</span><span class="p">()</span>
        <span class="n">acqDelayMax</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">get_acquisition_delay_maximum</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;acquisitionDelay(device): acqDelay     =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">acqDelay</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;acquisitionDelay(device): acqDelayInc  =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">acqDelayInc</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;acquisitionDelay(device): acqDelayMin  =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">acqDelayMin</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;acquisitionDelay(device): acqDelayMax  =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">acqDelayMax</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="c1"># Now to set the delay value</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">set_acquisition_delay</span><span class="p">(</span><span class="n">delay_value</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;acquisitionDelay(device): set acqDelay =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">delay_value</span><span class="p">)</span>

            <span class="c1"># Print the new delay value to check</span>
            <span class="n">acqDelay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_acquisition_delay</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;acquisitionDelay(device): get acqDelay(expected </span><span class="si">%d</span><span class="s2">)  =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">delay_value</span><span class="p">,</span><span class="n">acqDelay</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_set_analyser_boxcar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scanToAve</span><span class="p">,</span> <span class="n">boxcarWidth</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function to smoothen the read spectrum using the boxcar method.</span>
<span class="sd">        Basically, it takes the points around it and averages them out.</span>
<span class="sd">        It also takes several acquisition data and averages them too, hence the name boxcar.</span>

<span class="sd">        Args:</span>
<span class="sd">            scanToAve (int): the number of scan acquisition to be averaged out</span>
<span class="sd">            boxcarWidth (int): the number of neighboring data points to be averaged out</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Set the device to set up as the device of this current class instance</span>
        <span class="n">device</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">get_scans_to_average</span><span class="p">()</span> <span class="c1">#Gets the number of spectra to average.</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;scanToAverageBoxcar(): cur scans_to_average        =  </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="p">)</span>

            <span class="n">value</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">get_integration_time</span><span class="p">()</span> <span class="c1">#Returns the current integration time on the device in microseconds.</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;scanToAverageBoxcar(): current integrationTimeUs   =  </span><span class="si">%d</span><span class="s2">us&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="p">)</span>

            <span class="n">minAveIntTime</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">get_minimum_averaging_integration_time</span><span class="p">()</span>
            <span class="c1"># This function returns the smallest integration time setting, in microseconds, that is valid for the spectrometer.</span>
            <span class="c1"># NOTE: some devices that make use of onboard functionality to perform averaging have a different, larger, minimum integration time</span>
            <span class="c1"># for acquisition when averaging is enabled. Refer to the documentation for your spectrometer to see if this is the case. The </span>
            <span class="c1"># minimum integration time when averaging is enabled can be determined using odapi_get_minimum_averaging_integration_time_micros.</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;scanToAverageBoxcar(): minAverageIntegrationTimeUs =  </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">minAveIntTime</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="p">[</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">get_error_details</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;scanToAverageBoxcar(): set/get / </span><span class="si">%d</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Sets the number of spectra to average.</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;scanToAverageBoxcar(): set_scans_to_average        =  </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">scanToAve</span><span class="p">)</span>
            <span class="n">device</span><span class="o">.</span><span class="n">set_scans_to_average</span><span class="p">(</span><span class="n">scanToAve</span><span class="p">)</span>
        <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="p">[</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">get_error_details</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;scanToAverageBoxcar(): ERROR with code/scanToAverage, </span><span class="si">%d</span><span class="s2"> = </span><span class="si">%s</span><span class="s2"> ************&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">scanToAve</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Print to check the new value</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">get_scans_to_average</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;scanToAverageBoxcar(): get_scans_to_average        =  </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="p">)</span>

        <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="p">[</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">get_error_details</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;scanToAverageBoxcar(device): set/get / </span><span class="si">%d</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Sets the boxcar width to average the spectral data.</span>
            <span class="n">device</span><span class="o">.</span><span class="n">set_boxcar_width</span><span class="p">(</span><span class="n">boxcarWidth</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;scanToAverageBoxcar(): set_boxcar_width            =  </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">boxcarWidth</span><span class="p">)</span>

            <span class="c1"># Print to check the boxcar width we just set</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">get_boxcar_width</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;scanToAverageBoxcar(): get_boxcar_width            =  </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="p">)</span>

        <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="p">[</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">get_error_details</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;scanToAverageBoxcar(): set/get / </span><span class="si">%d</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">measure_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        A function to measure the spectrum of the Raman spectrometer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[pd.DataFrame, int, int]: A tuple containing the following:</span>
<span class="sd">                - pandas.DataFrame: A DataFrame containing the measured spectrum with the wavelength and</span>
<span class="sd">                    intensity columns, from the config file. (as a global constant)</span>
<span class="sd">                - int: The timestamp of the measurement in integer format (microseconds).</span>
<span class="sd">                - int: The integration time used for the measurement in microseconds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">==</span> <span class="s1">&#39;continuous&#39;</span><span class="p">:</span>
                <span class="n">timestamp</span> <span class="o">=</span> <span class="n">get_timestamp_us_int</span><span class="p">()</span>
                <span class="n">intensity_raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_formatted_spectrum</span><span class="p">()</span>
                <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">timestamp</span> <span class="o">+</span> <span class="n">get_timestamp_us_int</span><span class="p">())</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">==</span> <span class="s1">&#39;discreet&#39;</span><span class="p">:</span>
                <span class="c1"># new method:</span>
                <span class="n">adv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">Advanced</span>
                <span class="n">adv</span><span class="o">.</span><span class="n">abort_acquisition</span><span class="p">()</span>
                <span class="n">adv</span><span class="o">.</span><span class="n">clear_data_buffer</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_mea</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_ts</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

                <span class="n">adv</span><span class="o">.</span><span class="n">acquire_spectra_to_buffer</span><span class="p">()</span>
                <span class="n">adv</span><span class="o">.</span><span class="n">get_raw_spectrum_with_metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_mea</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_ts</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

                <span class="n">adv</span><span class="o">.</span><span class="n">abort_acquisition</span><span class="p">()</span>
                <span class="n">adv</span><span class="o">.</span><span class="n">clear_data_buffer</span><span class="p">()</span>

                <span class="n">intensity_raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_mea</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">timestamp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_ts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_timestamp</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset_timestamp</span>

            <span class="n">wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wavelength</span>
            <span class="n">integration_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_integration_time</span><span class="p">()</span>

        <span class="c1"># Convert ctypes LP_c_double objects to Python floats</span>
        <span class="c1"># The Ocean Direct API returns ctypes objects that need to be converted</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># For continuous mode: intensity_raw is a ctypes array</span>
            <span class="c1"># For discrete mode: intensity_raw is a ctypes POINTER(c_double)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">intensity_raw</span><span class="p">,</span> <span class="s1">&#39;_length_&#39;</span><span class="p">):</span>
                <span class="c1"># It&#39;s a ctypes array, convert each element</span>
                <span class="n">intensity</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">intensity_raw</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">intensity_raw</span><span class="p">))]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># It&#39;s a ctypes pointer, convert each element by indexing</span>
                <span class="c1"># Get the length from wavelength array since they should match</span>
                <span class="n">intensity</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">intensity_raw</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wavelength</span><span class="p">))]</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
            <span class="c1"># Fallback: if intensity_raw is already a list of floats, use as-is</span>
            <span class="n">intensity</span> <span class="o">=</span> <span class="n">intensity_raw</span>

        <span class="n">spectra</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="n">DataAnalysisConfigEnum</span><span class="o">.</span><span class="n">WAVELENGTH_LABEL</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">wavelength</span><span class="p">,</span>
            <span class="n">DataAnalysisConfigEnum</span><span class="o">.</span><span class="n">INTENSITY_LABEL</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">intensity</span><span class="p">,</span>
        <span class="p">})</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">spectra</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">integration_time</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">self_test_get_spec_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Q. Honestly, I don&#39;t really understand what this does.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">device</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span>
        <span class="n">sn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev_serial</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1">#100ms</span>
            <span class="n">device</span><span class="o">.</span><span class="n">set_integration_time</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reading spectra for dev s/n = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sn</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
                <span class="n">spectra</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">get_formatted_spectrum</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;spectra[100]: </span><span class="si">%d</span><span class="s2">, </span><span class="si">%d</span><span class="s2">, </span><span class="si">%d</span><span class="s2">, </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">spectra</span><span class="p">[</span><span class="mi">100</span><span class="p">],</span> <span class="n">spectra</span><span class="p">[</span><span class="mi">101</span><span class="p">],</span> <span class="n">spectra</span><span class="p">[</span><span class="mi">102</span><span class="p">],</span> <span class="n">spectra</span><span class="p">[</span><span class="mi">103</span><span class="p">]),</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="p">[</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">get_error_details</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;get_spec_formatted(device): exception / </span><span class="si">%d</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">))</span>


<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        To set up an external light source</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">device</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span>
        <span class="n">periodInc</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">periodInc</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">get_continuous_strobe_period_increment</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): period increment =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">periodInc</span><span class="p">)</span>
        <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="p">[</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">get_error_details</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): get_continuous_strobe_period_increment() </span><span class="si">%d</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">))</span>

        <span class="n">strobePeriod</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">get_continuous_strobe_period</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): get strobePeriod =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">strobePeriod</span><span class="p">)</span>

        <span class="n">strobeEnable</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">get_continuous_strobe_enable</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): get strobeEnable =  </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">strobeEnable</span><span class="p">)</span>

        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">enable</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">set_continuous_strobe_enable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): get strobeEnable =  </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">enable</span><span class="p">)</span>
            <span class="n">strobeEnable</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">get_continuous_strobe_enable</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): set strobeEnable =  </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">enable</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">periodMin</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">get_continuous_strobe_period_minimum</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): periodMin          =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">periodMin</span><span class="p">)</span>
        <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="p">[</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">get_error_details</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): get_continuous_strobe_period_minimum() </span><span class="si">%d</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">periodMax</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">get_continuous_strobe_period_maximum</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): periodMax          =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">periodMax</span><span class="p">)</span>
        <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="p">[</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">get_error_details</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): get_continuous_strobe_period_maximum() </span><span class="si">%d</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">))</span>



        <span class="n">strobePeriodList</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">1505</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">453</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">strobePeriodList</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">periodInc</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">((</span><span class="n">period</span> <span class="o">%</span> <span class="n">periodInc</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): set strobePeriod =  </span><span class="si">%d</span><span class="s2">  ====&gt; ********* expecting EXCEPTION!&quot;</span> <span class="o">%</span> <span class="n">period</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">set_continuous_strobe_period</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): set strobePeriod =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">period</span><span class="p">)</span>
            <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="p">[</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">get_error_details</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): set_continuous_strobe_period() </span><span class="si">%d</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">))</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">period</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">get_continuous_strobe_period</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): get strobePeriod =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">period</span><span class="p">)</span>
            <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="p">[</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">get_error_details</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): get_continuous_strobe_period() </span><span class="si">%d</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">strobeWidth</span> <span class="o">=</span> <span class="mi">216</span>
            <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">set_continuous_strobe_width</span><span class="p">(</span><span class="n">strobeWidth</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): set strobeWidth    =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">strobeWidth</span><span class="p">)</span>

            <span class="n">strobeWidth</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">get_continuous_strobe_width</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): get strobeWidth    =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">strobeWidth</span><span class="p">)</span>
        <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="p">[</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">get_error_details</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): </span><span class="si">%d</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">))</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="c1"># Set of commands for testing/automation</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">self_test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_acquisitionDelay</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_analyser_boxcar</span><span class="p">(</span><span class="n">scanToAve</span><span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">boxcarWidth</span><span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">self_test_get_spec_formatted</span><span class="p">()</span>

        <span class="c1">#Reset the analyser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_analyser_boxcar</span><span class="p">(</span><span class="n">scanToAve</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">boxcarWidth</span><span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.get_identifier" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_identifier</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the identifier of the spectrometer.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The identifier of the spectrometer</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/controllers/raman_spectrometer_controller_QEPro.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the identifier of the spectrometer.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The identifier of the spectrometer</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_identifier</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.get_integration_time_limits_us" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_integration_time_limits_us</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the integration time limits of the device</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing the minimum, maximum, and increment of the integration time in [device unit] (microseconds for the QE Pro)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/controllers/raman_spectrometer_controller_QEPro.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_integration_time_limits_us</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the integration time limits of the device</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple containing the minimum, maximum, and increment of the integration time in [device unit] (microseconds for the QE Pro)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">integration_time_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">integration_time_max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">integration_time_inc</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.get_integration_time_us" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_integration_time_us</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the integration time of the device</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Integration time in [device unit] (microseconds for the QE Pro)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/controllers/raman_spectrometer_controller_QEPro.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_integration_time_us</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the integration time of the device</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: Integration time in [device unit] (microseconds for the QE Pro)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
        <span class="n">int_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_integration_time</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">int_time</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.initialisation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initialisation</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initializes the Raman spectrometer controller.</p>
<p>This function performs the following tasks:
1. Prints the API info and the number of devices connected.
2. Checks if any device is found. If not, it terminates the program.
3. Checks if more than one device is found. If so, it terminates the program.
4. Creates a device instance using the first device in the device list.
5. Retrieves the serial number of the device.
6. Retrieves the integration time requirements of the device.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/controllers/raman_spectrometer_controller_QEPro.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">initialisation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes the Raman spectrometer controller.</span>

<span class="sd">    This function performs the following tasks:</span>
<span class="sd">    1. Prints the API info and the number of devices connected.</span>
<span class="sd">    2. Checks if any device is found. If not, it terminates the program.</span>
<span class="sd">    3. Checks if more than one device is found. If so, it terminates the program.</span>
<span class="sd">    4. Creates a device instance using the first device in the device list.</span>
<span class="sd">    5. Retrieves the serial number of the device.</span>
<span class="sd">    6. Retrieves the integration time requirements of the device.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Print the API info and the devices connected</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;API Version  : </span><span class="si">%d</span><span class="s2">.</span><span class="si">%d</span><span class="s2">.</span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_info</span><span class="p">)</span>   <span class="c1"># if this doesn&#39;t work, try (self.api_info[0],self.api_info[1],self.api_info[2])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total Device : </span><span class="si">%d</span><span class="s2">     </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev_count</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt; No device found &lt;&lt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev_count</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt; More than 1 device is found &lt;&lt;&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The program has not been designed to handle more than 1 devices and thus will be shut down&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminate</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># Create a device instance by taking the 1st in the device list</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dev_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">od</span><span class="o">.</span><span class="n">open_device</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dev_id</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dev_serial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_serial_number</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First Device : </span><span class="si">%d</span><span class="s2">       &quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev_id</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Serial Number: </span><span class="si">%s</span><span class="s2">     </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev_serial</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_identifier</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Ocean Insight, device id: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dev_id</span><span class="si">}</span><span class="s2">, S/N:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dev_serial</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Retrieve the integration time requirements of the device</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">integration_time_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_maximum_integration_time</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">integration_time_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_minimum_integration_time</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">integration_time_inc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_integration_time_increment</span><span class="p">()</span>

    <span class="c1"># Initialise the timestamp</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">==</span> <span class="s1">&#39;discreet&#39;</span><span class="p">:</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="n">int_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_integration_time</span><span class="p">()</span>
            <span class="n">min_int_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_minimum_integration_time</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">set_integration_time</span><span class="p">(</span><span class="n">min_int_time</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_init_timestamp</span> <span class="o">=</span> <span class="n">get_timestamp_us_int</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_mea</span><span class="o">.</span><span class="n">clear</span><span class="p">();</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_ts</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

            <span class="c1"># self.dev.Advanced.set_number_of_backtoback_scans(1)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">acquire_spectra_to_buffer</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">get_raw_spectrum_with_metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_mea</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_ts</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_offset_timestamp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_ts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">set_integration_time</span><span class="p">(</span><span class="n">int_time</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">==</span> <span class="s1">&#39;continuous&#39;</span><span class="p">:</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">acquire_spectra_to_buffer</span><span class="p">()</span>

    <span class="c1"># Grab the wavelengths of the device</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_wavelengths</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.measure_spectrum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">measure_spectrum</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>A function to measure the spectrum of the Raman spectrometer.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[pd.DataFrame, int, int]: A tuple containing the following:
- pandas.DataFrame: A DataFrame containing the measured spectrum with the wavelength and
    intensity columns, from the config file. (as a global constant)
- int: The timestamp of the measurement in integer format (microseconds).
- int: The integration time used for the measurement in microseconds.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/controllers/raman_spectrometer_controller_QEPro.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">measure_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    A function to measure the spectrum of the Raman spectrometer.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[pd.DataFrame, int, int]: A tuple containing the following:</span>
<span class="sd">            - pandas.DataFrame: A DataFrame containing the measured spectrum with the wavelength and</span>
<span class="sd">                intensity columns, from the config file. (as a global constant)</span>
<span class="sd">            - int: The timestamp of the measurement in integer format (microseconds).</span>
<span class="sd">            - int: The integration time used for the measurement in microseconds.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">==</span> <span class="s1">&#39;continuous&#39;</span><span class="p">:</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="n">get_timestamp_us_int</span><span class="p">()</span>
            <span class="n">intensity_raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_formatted_spectrum</span><span class="p">()</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">timestamp</span> <span class="o">+</span> <span class="n">get_timestamp_us_int</span><span class="p">())</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">==</span> <span class="s1">&#39;discreet&#39;</span><span class="p">:</span>
            <span class="c1"># new method:</span>
            <span class="n">adv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">Advanced</span>
            <span class="n">adv</span><span class="o">.</span><span class="n">abort_acquisition</span><span class="p">()</span>
            <span class="n">adv</span><span class="o">.</span><span class="n">clear_data_buffer</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_mea</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_ts</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

            <span class="n">adv</span><span class="o">.</span><span class="n">acquire_spectra_to_buffer</span><span class="p">()</span>
            <span class="n">adv</span><span class="o">.</span><span class="n">get_raw_spectrum_with_metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_mea</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_ts</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

            <span class="n">adv</span><span class="o">.</span><span class="n">abort_acquisition</span><span class="p">()</span>
            <span class="n">adv</span><span class="o">.</span><span class="n">clear_data_buffer</span><span class="p">()</span>

            <span class="n">intensity_raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_mea</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_list_ts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_timestamp</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset_timestamp</span>

        <span class="n">wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wavelength</span>
        <span class="n">integration_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_integration_time</span><span class="p">()</span>

    <span class="c1"># Convert ctypes LP_c_double objects to Python floats</span>
    <span class="c1"># The Ocean Direct API returns ctypes objects that need to be converted</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># For continuous mode: intensity_raw is a ctypes array</span>
        <span class="c1"># For discrete mode: intensity_raw is a ctypes POINTER(c_double)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">intensity_raw</span><span class="p">,</span> <span class="s1">&#39;_length_&#39;</span><span class="p">):</span>
            <span class="c1"># It&#39;s a ctypes array, convert each element</span>
            <span class="n">intensity</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">intensity_raw</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">intensity_raw</span><span class="p">))]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># It&#39;s a ctypes pointer, convert each element by indexing</span>
            <span class="c1"># Get the length from wavelength array since they should match</span>
            <span class="n">intensity</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">intensity_raw</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wavelength</span><span class="p">))]</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
        <span class="c1"># Fallback: if intensity_raw is already a list of floats, use as-is</span>
        <span class="n">intensity</span> <span class="o">=</span> <span class="n">intensity_raw</span>

    <span class="n">spectra</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="n">DataAnalysisConfigEnum</span><span class="o">.</span><span class="n">WAVELENGTH_LABEL</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">wavelength</span><span class="p">,</span>
        <span class="n">DataAnalysisConfigEnum</span><span class="o">.</span><span class="n">INTENSITY_LABEL</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">intensity</span><span class="p">,</span>
    <span class="p">})</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">spectra</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">integration_time</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.self_test_get_spec_formatted" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">self_test_get_spec_formatted</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Q. Honestly, I don't really understand what this does.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/controllers/raman_spectrometer_controller_QEPro.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">self_test_get_spec_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Q. Honestly, I don&#39;t really understand what this does.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">device</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span>
    <span class="n">sn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev_serial</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1">#100ms</span>
        <span class="n">device</span><span class="o">.</span><span class="n">set_integration_time</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reading spectra for dev s/n = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sn</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">spectra</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">get_formatted_spectrum</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;spectra[100]: </span><span class="si">%d</span><span class="s2">, </span><span class="si">%d</span><span class="s2">, </span><span class="si">%d</span><span class="s2">, </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">spectra</span><span class="p">[</span><span class="mi">100</span><span class="p">],</span> <span class="n">spectra</span><span class="p">[</span><span class="mi">101</span><span class="p">],</span> <span class="n">spectra</span><span class="p">[</span><span class="mi">102</span><span class="p">],</span> <span class="n">spectra</span><span class="p">[</span><span class="mi">103</span><span class="p">]),</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="p">[</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">get_error_details</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;get_spec_formatted(device): exception / </span><span class="si">%d</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">))</span>


<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    To set up an external light source</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">device</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span>
    <span class="n">periodInc</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">periodInc</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">get_continuous_strobe_period_increment</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): period increment =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">periodInc</span><span class="p">)</span>
    <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="p">[</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">get_error_details</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): get_continuous_strobe_period_increment() </span><span class="si">%d</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">))</span>

    <span class="n">strobePeriod</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">get_continuous_strobe_period</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): get strobePeriod =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">strobePeriod</span><span class="p">)</span>

    <span class="n">strobeEnable</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">get_continuous_strobe_enable</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): get strobeEnable =  </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">strobeEnable</span><span class="p">)</span>

    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">enable</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
        <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">set_continuous_strobe_enable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): get strobeEnable =  </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">enable</span><span class="p">)</span>
        <span class="n">strobeEnable</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">get_continuous_strobe_enable</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): set strobeEnable =  </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">enable</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">periodMin</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">get_continuous_strobe_period_minimum</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): periodMin          =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">periodMin</span><span class="p">)</span>
    <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="p">[</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">get_error_details</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): get_continuous_strobe_period_minimum() </span><span class="si">%d</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">))</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">periodMax</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">get_continuous_strobe_period_maximum</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): periodMax          =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">periodMax</span><span class="p">)</span>
    <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="p">[</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">get_error_details</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): get_continuous_strobe_period_maximum() </span><span class="si">%d</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">))</span>



    <span class="n">strobePeriodList</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">1505</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">453</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">strobePeriodList</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">periodInc</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">((</span><span class="n">period</span> <span class="o">%</span> <span class="n">periodInc</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): set strobePeriod =  </span><span class="si">%d</span><span class="s2">  ====&gt; ********* expecting EXCEPTION!&quot;</span> <span class="o">%</span> <span class="n">period</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">set_continuous_strobe_period</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): set strobePeriod =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">period</span><span class="p">)</span>
        <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="p">[</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">get_error_details</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): set_continuous_strobe_period() </span><span class="si">%d</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">period</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">get_continuous_strobe_period</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): get strobePeriod =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">period</span><span class="p">)</span>
        <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="p">[</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">get_error_details</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): get_continuous_strobe_period() </span><span class="si">%d</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">strobeWidth</span> <span class="o">=</span> <span class="mi">216</span>
        <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">set_continuous_strobe_width</span><span class="p">(</span><span class="n">strobeWidth</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): set strobeWidth    =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">strobeWidth</span><span class="p">)</span>

        <span class="n">strobeWidth</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">Advanced</span><span class="o">.</span><span class="n">get_continuous_strobe_width</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): get strobeWidth    =  </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">strobeWidth</span><span class="p">)</span>
    <span class="k">except</span> <span class="bp">self</span><span class="o">.</span><span class="n">OceanDirectError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="p">[</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">get_error_details</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;continuousStrobe(device): </span><span class="si">%d</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.set_integration_time_us" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_integration_time_us</span><span class="p">(</span><span class="n">integration_time</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Sets the integration time of the device</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>integration_time</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Integration time in [device unit] </p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Device integrationt time after set up</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/controllers/raman_spectrometer_controller_QEPro.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_integration_time_us</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">integration_time</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the integration time of the device</span>

<span class="sd">    Args:</span>
<span class="sd">        integration_time (int): Integration time in [device unit] </span>
<span class="sd">        (microseconds for the QE Pro)</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: Device integrationt time after set up</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;work here (raman spectrometer controller file)&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">integration_time</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">integration_time</span><span class="p">,</span><span class="nb">float</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Integration time must be an integer&quot;</span><span class="p">)</span>
    <span class="n">integration_time</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">integration_time</span><span class="p">)</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">set_integration_time</span><span class="p">(</span><span class="n">integration_time</span><span class="p">)</span>
        <span class="n">int_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">get_integration_time</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">int_time</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="iris.controllers.raman_spectrometer_controller_QEPro.SpectrometerController_QEPro.terminate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">terminate</span><span class="p">(</span><span class="n">error_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>To terminate the connections to the Raman spectrometers</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>error_flag</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Can also passes an error message. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/controllers/raman_spectrometer_controller_QEPro.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">terminate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    To terminate the connections to the Raman spectrometers</span>

<span class="sd">    Args:</span>
<span class="sd">        error_flag (bool, optional): Can also passes an error message. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">error_flag</span><span class="o">!=</span><span class="kc">False</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Error code:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">error_flag</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dev_ids</span><span class="p">)):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">od</span><span class="o">.</span><span class="n">close_device</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dev_ids</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&gt;&gt;&gt;&gt;&gt; Raman controller TERMINATED &lt;&lt;&lt;&lt;&lt;&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ocean Insight devices disconnected&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="iris.controllers.raman_spectrometer_controller_QEPro.check_and_create_config_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_and_create_config_file</span><span class="p">(</span><span class="n">config_file_path</span><span class="o">=</span><span class="s1">&#39;config.ini&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Generate a default config file if it does not exist</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_file</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the config file. Defaults to 'config.ini'</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/utils/general.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_and_create_config_file</span><span class="p">(</span><span class="n">config_file_path</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="s1">&#39;config.ini&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a default config file if it does not exist</span>

<span class="sd">    Args:</span>
<span class="sd">        config_file (str): Path to the config file. Defaults to &#39;config.ini&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate a default config file if it does not exist</span>
    <span class="n">updater</span> <span class="o">=</span> <span class="n">ConfigUpdater</span><span class="p">(</span><span class="n">allow_no_value</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">config_file_path</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">configfile</span><span class="p">:</span> <span class="n">updater</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">configfile</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="iris.controllers.raman_spectrometer_controller_QEPro.convert_ramanshift_to_wavelength" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_ramanshift_to_wavelength</span><span class="p">(</span><span class="n">raman_shift</span><span class="p">,</span> <span class="n">excitation_wavelength</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Converts Raman shift to wavelength</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>raman_shift</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raman shift in cm^-1</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>excitation_wavelength</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Excitation laser wavelength in nm</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span> | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>float|np.ndarray: Wavelength in nm</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/utils/general.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_ramanshift_to_wavelength</span><span class="p">(</span><span class="n">raman_shift</span><span class="p">:</span><span class="nb">float</span><span class="o">|</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span><span class="n">excitation_wavelength</span><span class="p">:</span><span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="o">|</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts Raman shift to wavelength</span>

<span class="sd">    Args:</span>
<span class="sd">        raman_shift (float|np.ndarray): Raman shift in cm^-1</span>
<span class="sd">        excitation_wavelength (float): Excitation laser wavelength in nm</span>

<span class="sd">    Returns:</span>
<span class="sd">        float|np.ndarray: Wavelength in nm</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wavelength</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">excitation_wavelength</span> <span class="o">-</span> <span class="n">raman_shift</span><span class="o">/</span><span class="mf">1e7</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wavelength</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="iris.controllers.raman_spectrometer_controller_QEPro.convert_timestamp_us_int_to_str" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_timestamp_us_int_to_str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Converts timestamp integer to string</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>timestamp</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timestamp in us</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timestamp as string in the format %y%m%d_%H%M%S_%f</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/utils/general.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_timestamp_us_int_to_str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts timestamp integer to string</span>

<span class="sd">    Args:</span>
<span class="sd">        timestamp (int): Timestamp in us</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Timestamp as string in the format %y%m%d_%H%M%S_%f</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">timestamp_str</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">timestamp</span><span class="o">*</span><span class="mf">1e-6</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%y%m</span><span class="si">%d</span><span class="s2">_%H%M%S_</span><span class="si">%f</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">timestamp_str</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="iris.controllers.raman_spectrometer_controller_QEPro.convert_timestamp_us_str_to_int" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_timestamp_us_str_to_int</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Converts timestamp string to integer</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>timestamp</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timestamp, has to be in the format %y%m%d_%H%M%S_%f</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timestamp as integer in us</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/utils/general.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_timestamp_us_str_to_int</span><span class="p">(</span><span class="n">timestamp</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts timestamp string to integer</span>

<span class="sd">    Args:</span>
<span class="sd">        timestamp (str): Timestamp, has to be in the format %y%m%d_%H%M%S_%f</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: Timestamp as integer in us</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">timestamp_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">timestamp</span><span class="p">,</span> <span class="s2">&quot;%y%m</span><span class="si">%d</span><span class="s2">_%H%M%S_</span><span class="si">%f</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span><span class="o">*</span><span class="mf">1e6</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">timestamp_int</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="iris.controllers.raman_spectrometer_controller_QEPro.convert_wavelength_to_ramanshift" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_wavelength_to_ramanshift</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">excitation_wavelength</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Converts wavelength to Raman shift</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>wavelength</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Wavelength in nm</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>excitation_wavelength</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Excitation laser wavelength in nm</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span> | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>float|np.ndarray: Raman shift in cm^-1</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/utils/general.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_wavelength_to_ramanshift</span><span class="p">(</span><span class="n">wavelength</span><span class="p">:</span><span class="nb">float</span><span class="o">|</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span><span class="n">excitation_wavelength</span><span class="p">:</span><span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="o">|</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts wavelength to Raman shift</span>

<span class="sd">    Args:</span>
<span class="sd">        wavelength (float|np.ndarray): Wavelength in nm</span>
<span class="sd">        excitation_wavelength (float): Excitation laser wavelength in nm</span>

<span class="sd">    Returns:</span>
<span class="sd">        float|np.ndarray: Raman shift in cm^-1</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">and</span> <span class="n">wavelength</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">wavelength</span> <span class="o">=</span> <span class="mf">0.0001</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">wavelength</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">wavelength</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">)</span>
    <span class="n">raman_shift</span> <span class="o">=</span> <span class="mf">1e7</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">excitation_wavelength</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">wavelength</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">raman_shift</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="iris.controllers.raman_spectrometer_controller_QEPro.generate_test_app" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_test_app</span><span class="p">(</span><span class="n">lyt</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Generates a test QApplication and QVBoxLayout for testing purposes</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="PySide6.QtWidgets.QApplication">QApplication</span>, <span title="PySide6.QtWidgets.QWidget">QWidget</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[qw.QApplication, qw.QWidget]: The QApplication and QWidget instances</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/utils/general.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_test_app</span><span class="p">(</span><span class="n">lyt</span><span class="p">:</span><span class="n">qw</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="o">|</span><span class="n">qw</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">qw</span><span class="o">.</span><span class="n">QApplication</span><span class="p">,</span><span class="n">qw</span><span class="o">.</span><span class="n">QWidget</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a test QApplication and QVBoxLayout for testing purposes</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[qw.QApplication, qw.QWidget]: The QApplication and QWidget instances</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">qw</span><span class="o">.</span><span class="n">QApplication</span><span class="p">([])</span>
    <span class="n">main_window</span> <span class="o">=</span> <span class="n">qw</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">()</span>
    <span class="n">main_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">wdg</span> <span class="o">=</span> <span class="n">qw</span><span class="o">.</span><span class="n">QWidget</span><span class="p">()</span>
    <span class="n">main_window</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="n">wdg</span><span class="p">)</span>
    <span class="n">wdg</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">lyt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">app</span><span class="p">,</span> <span class="n">wdg</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="iris.controllers.raman_spectrometer_controller_QEPro.get_all_widgets" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_all_widgets</span><span class="p">(</span><span class="n">parent_widget</span><span class="p">,</span> <span class="n">get_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>A function that returns all widgets in a frame and optionally, its subframes (all levels)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parent_widget</code>
            </td>
            <td>
                  <code><span title="PySide6.QtWidgets.QWidget">QWidget</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Widget which children need to be listed</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>get_all</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True it will get the widgets in the sub-widgets as well</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="PySide6.QtWidgets.QWidget">QWidget</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[qw.QWidget]: List of all widgets in the widget</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/utils/general.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_all_widgets</span><span class="p">(</span><span class="n">parent_widget</span><span class="p">:</span><span class="n">qw</span><span class="o">.</span><span class="n">QWidget</span><span class="p">,</span><span class="n">get_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">qw</span><span class="o">.</span><span class="n">QWidget</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function that returns all widgets in a frame and optionally, its subframes (all levels)</span>

<span class="sd">    Args:</span>
<span class="sd">        parent_widget (qw.QWidget): Widget which children need to be listed</span>
<span class="sd">        get_all (bool, optional): If True it will get the widgets in the sub-widgets as well</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[qw.QWidget]: List of all widgets in the widget</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">get_all</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">parent_widget</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">qw</span><span class="o">.</span><span class="n">QWidget</span><span class="p">)</span>   <span class="c1"># The default findChildren() is already recursive</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># findChildren() with a search option that limits depth</span>
        <span class="c1"># For a single level, findChildren(type, options) is useful</span>
        <span class="c1"># We find widgets that are immediate children of the parent.</span>
        <span class="k">return</span> <span class="n">parent_widget</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">qw</span><span class="o">.</span><span class="n">QWidget</span><span class="p">,</span> <span class="n">qc</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">FindChildOption</span><span class="o">.</span><span class="n">FindDirectChildrenOnly</span><span class="p">)</span> <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="iris.controllers.raman_spectrometer_controller_QEPro.get_all_widgets_from_layout" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_all_widgets_from_layout</span><span class="p">(</span><span class="n">parent_layout</span><span class="p">,</span> <span class="n">get_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>A function that returns all widgets in a layout and optionally, its sub-layouts (all levels)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parent_layout</code>
            </td>
            <td>
                  <code><span title="PySide6.QtWidgets.QLayout">QLayout</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Layout which children need to be listed</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>get_all</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True it will get the widgets in the sub-layouts as well</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="PySide6.QtWidgets.QWidget">QWidget</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[qw.QWidget]: List of all widgets in the layout</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/utils/general.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_all_widgets_from_layout</span><span class="p">(</span><span class="n">parent_layout</span><span class="p">:</span><span class="n">qw</span><span class="o">.</span><span class="n">QLayout</span><span class="p">,</span><span class="n">get_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">qw</span><span class="o">.</span><span class="n">QWidget</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function that returns all widgets in a layout and optionally, its sub-layouts (all levels)</span>

<span class="sd">    Args:</span>
<span class="sd">        parent_layout (qw.QLayout): Layout which children need to be listed</span>
<span class="sd">        get_all (bool, optional): If True it will get the widgets in the sub-layouts as well</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[qw.QWidget]: List of all widgets in the layout</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">list_widget</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">parent_layout</span><span class="o">.</span><span class="n">count</span><span class="p">()):</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">parent_layout</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">widget</span><span class="p">():</span>
            <span class="n">list_widget</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">widget</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">get_all</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">widget</span><span class="p">(),</span> <span class="n">qw</span><span class="o">.</span><span class="n">QWidget</span><span class="p">):</span>
                <span class="n">child_widgets</span> <span class="o">=</span> <span class="n">get_all_widgets</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">widget</span><span class="p">(),</span> <span class="n">get_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">list_widget</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">child_widgets</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">item</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span> <span class="ow">and</span> <span class="n">get_all</span><span class="p">:</span>
            <span class="n">child_widgets</span> <span class="o">=</span> <span class="n">get_all_widgets_from_layout</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">layout</span><span class="p">(),</span> <span class="n">get_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">list_widget</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">child_widgets</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">list_widget</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="iris.controllers.raman_spectrometer_controller_QEPro.get_timestamp_day" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_timestamp_day</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Gets the current timestamp in days</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timestamp without time: yymmdd</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/utils/general.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_timestamp_day</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets the current timestamp in days</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Timestamp without time: yymmdd</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%y%m</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="iris.controllers.raman_spectrometer_controller_QEPro.get_timestamp_sec" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_timestamp_sec</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Gets the current timestamp in seconds</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timestamp with time: yymmdd_hhmmss</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/utils/general.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_timestamp_sec</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets the current timestamp in seconds</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Timestamp with time: yymmdd_hhmmss</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="iris.controllers.raman_spectrometer_controller_QEPro.get_timestamp_us_int" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_timestamp_us_int</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Gets the current timestamp in us as integer</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timestamp in us</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/utils/general.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_timestamp_us_int</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets the current timestamp in us as integer</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: Timestamp in us</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span><span class="o">*</span><span class="mf">1e6</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="iris.controllers.raman_spectrometer_controller_QEPro.get_timestamp_us_str" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_timestamp_us_str</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Gets the current timestamp in us as string</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timestamp with time and milliseconds: yymmdd_hhmmss_us(6 digits)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/utils/general.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_timestamp_us_str</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets the current timestamp in us as string</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Timestamp with time and milliseconds: yymmdd_hhmmss_us(6 digits)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%y%m</span><span class="si">%d</span><span class="s2">_%H%M%S_</span><span class="si">%f</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="iris.controllers.raman_spectrometer_controller_QEPro.messagebox_request_input" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">messagebox_request_input</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">validator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">invalid_msg</span><span class="o">=</span><span class="s1">&#39;The entered value is invalid. Please try again.&#39;</span><span class="p">,</span> <span class="n">loop_until_valid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>A function that creates a QInputDialog to request input with optional validation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parent</code>
            </td>
            <td>
                  <code><span title="PySide6.QtWidgets.QWidget">QWidget</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The parent widget for the dialog (recommended).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Title of the dialog box.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Message/label to be displayed for the input field.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Default value of the input.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>validator</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="str">str</span>], <span title="bool">bool</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A function that takes the 
input string and returns True if valid, False otherwise.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>invalid_msg</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Message to show if validation fails.</p>
              </div>
            </td>
            <td>
                  <code>&#39;The entered value is invalid. Please try again.&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loop_until_valid</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, keeps asking until the input is valid 
or the user presses Cancel.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str | None: User input string if OK was pressed and validation passed, 
        otherwise None (if Cancel was pressed).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/utils/general.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">messagebox_request_input</span><span class="p">(</span>
        <span class="n">parent</span><span class="p">:</span> <span class="n">qw</span><span class="o">.</span><span class="n">QWidget</span><span class="p">,</span> 
        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
        <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
        <span class="n">default</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="n">validator</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">invalid_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;The entered value is invalid. Please try again.&quot;</span><span class="p">,</span>
        <span class="n">loop_until_valid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function that creates a QInputDialog to request input with optional validation.</span>

<span class="sd">    Args:</span>
<span class="sd">        parent (qw.QWidget): The parent widget for the dialog (recommended).</span>
<span class="sd">        title (str): Title of the dialog box.</span>
<span class="sd">        message (str): Message/label to be displayed for the input field.</span>
<span class="sd">        default (str, optional): Default value of the input.</span>
<span class="sd">        validator (Callable[[str], bool]|None, optional): A function that takes the </span>
<span class="sd">            input string and returns True if valid, False otherwise.</span>
<span class="sd">        invalid_msg (str): Message to show if validation fails.</span>
<span class="sd">        loop_until_valid (bool): If True, keeps asking until the input is valid </span>
<span class="sd">            or the user presses Cancel.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str | None: User input string if OK was pressed and validation passed, </span>
<span class="sd">                    otherwise None (if Cancel was pressed).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">current_default</span> <span class="o">=</span> <span class="n">default</span>

    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># 1. Show the input dialog</span>
        <span class="n">user_input</span><span class="p">,</span> <span class="n">ok</span> <span class="o">=</span> <span class="n">qw</span><span class="o">.</span><span class="n">QInputDialog</span><span class="o">.</span><span class="n">getText</span><span class="p">(</span>
            <span class="n">parent</span><span class="p">,</span>
            <span class="n">title</span><span class="p">,</span>
            <span class="n">message</span><span class="p">,</span>
            <span class="n">qw</span><span class="o">.</span><span class="n">QLineEdit</span><span class="o">.</span><span class="n">Normal</span><span class="p">,</span> <span class="c1"># pyright: ignore[reportAttributeAccessIssue]</span>
            <span class="n">current_default</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">ok</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># User pressed Cancel</span>

        <span class="n">is_valid</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">validator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">is_valid</span> <span class="o">=</span> <span class="n">validator</span><span class="p">(</span><span class="n">user_input</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_valid</span><span class="p">:</span> <span class="k">return</span> <span class="n">user_input</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">loop_until_valid</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">qw</span><span class="o">.</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="s2">&quot;Invalid Input&quot;</span><span class="p">,</span> <span class="n">invalid_msg</span><span class="p">)</span>
            <span class="n">current_default</span> <span class="o">=</span> <span class="n">user_input</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="iris.controllers.raman_spectrometer_controller_QEPro.read_update_config_file_section" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_update_config_file_section</span><span class="p">(</span><span class="n">dict_controllers_default</span><span class="p">,</span> <span class="n">dict_controllers_comments</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">config_file</span><span class="o">=</span><span class="s1">&#39;config.ini&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Read the config file and automatically add an entry if it does not exist
based on the given default values (dict form) and returns the read values
after the update. Additionally, it will also automatically append comments
given by the comments dictionary at the end of each respective key's value
in the config file. If the values are already present, it will just read the values.
If the config file is not present, it will automatically try to create one.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dict_controllers_default</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of the default values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_controllers_comments</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of the comments for each key in the default values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>section</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Section name in the config file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_file</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the config file. Defaults to 'config.ini'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;config.ini&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NotImplementedError">NotImplementedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the conversion of the default value type is not implemented</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of the read values (after the update) in the correct format
given by the default values dictionary</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/utils/general.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">read_update_config_file_section</span><span class="p">(</span><span class="n">dict_controllers_default</span><span class="p">:</span><span class="nb">dict</span><span class="p">,</span> <span class="n">dict_controllers_comments</span><span class="p">:</span><span class="nb">dict</span><span class="p">,</span>
    <span class="n">section</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">config_file</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="s1">&#39;config.ini&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read the config file and automatically add an entry if it does not exist</span>
<span class="sd">    based on the given default values (dict form) and returns the read values</span>
<span class="sd">    after the update. Additionally, it will also automatically append comments</span>
<span class="sd">    given by the comments dictionary at the end of each respective key&#39;s value</span>
<span class="sd">    in the config file. If the values are already present, it will just read the values.</span>
<span class="sd">    If the config file is not present, it will automatically try to create one.</span>

<span class="sd">    Args:</span>
<span class="sd">        dict_controllers_default (dict): Dictionary of the default values</span>
<span class="sd">        dict_controllers_comments (dict): Dictionary of the comments for each key in the default values</span>
<span class="sd">        section (str): Section name in the config file</span>
<span class="sd">        config_file (str, optional): Path to the config file. Defaults to &#39;config.ini&#39;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: If the conversion of the default value type is not implemented</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: Dictionary of the read values (after the update) in the correct format</span>
<span class="sd">            given by the default values dictionary</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">check_and_create_config_file</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>

    <span class="c1"># Read the config file and automatically add an entry if it does not exist </span>
    <span class="c1"># (along with its comments)</span>
    <span class="n">updater</span> <span class="o">=</span> <span class="n">ConfigUpdater</span><span class="p">(</span><span class="n">allow_no_value</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">updater</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>

    <span class="n">splitter</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span>
    <span class="n">commenter</span> <span class="o">=</span> <span class="s1">&#39;; &#39;</span>
    <span class="n">list_splitters</span> <span class="o">=</span> <span class="p">[</span><span class="n">splitter</span><span class="p">,</span> <span class="n">commenter</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">updater</span><span class="o">.</span><span class="n">has_section</span><span class="p">(</span><span class="n">section</span><span class="p">):</span>
        <span class="n">updater</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">updater</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_controllers_default</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">updater</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">dict_controllers_default</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">updater</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                    <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">,</span>
                    <span class="n">option</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
                    <span class="n">value</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dict_controllers_default</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">+</span> <span class="n">splitter</span> <span class="o">+</span> <span class="n">commenter</span> <span class="o">+</span> <span class="n">dict_controllers_comments</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>   <span class="c1"># Add quotes to the string values</span>
                <span class="n">updater</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                    <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">,</span>
                    <span class="n">option</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
                    <span class="n">value</span><span class="o">=</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dict_controllers_default</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">splitter</span> <span class="o">+</span> <span class="n">commenter</span> <span class="o">+</span> <span class="n">dict_controllers_comments</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="n">updater</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">dict_controllers_read</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">updater</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">updater</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="n">section</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_controllers_default</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="k">continue</span>
        <span class="n">def_val_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">dict_controllers_default</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

        <span class="c1"># Process different types of values separately</span>
        <span class="c1"># note that the splits are to remove the comments</span>
        <span class="k">if</span> <span class="n">def_val_type</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="n">read_line</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span>
            <span class="k">for</span> <span class="n">splitter</span> <span class="ow">in</span> <span class="n">list_splitters</span><span class="p">:</span>
                <span class="n">read_line</span> <span class="o">=</span> <span class="n">read_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">splitter</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">read_line</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="s1">&#39;true&#39;</span> <span class="ow">and</span> <span class="n">val</span> <span class="o">!=</span> <span class="s1">&#39;false&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2"> is not a boolean value.&quot;</span><span class="p">)</span>
            <span class="n">dict_controllers_read</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">read_line</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span>
        <span class="k">elif</span> <span class="n">def_val_type</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
            <span class="n">read_line</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span>
            <span class="k">for</span> <span class="n">splitter</span> <span class="ow">in</span> <span class="n">list_splitters</span><span class="p">:</span>
                <span class="n">read_line</span> <span class="o">=</span> <span class="n">read_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">splitter</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">conv_val</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">dict_controllers_default</span><span class="p">[</span><span class="n">key</span><span class="p">])(</span><span class="n">read_line</span><span class="p">)</span>
            <span class="n">dict_controllers_read</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">conv_val</span>
        <span class="k">elif</span> <span class="n">def_val_type</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;&quot;&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                <span class="n">conv_val</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">conv_val</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span>
                <span class="k">for</span> <span class="n">splitter</span> <span class="ow">in</span> <span class="n">list_splitters</span><span class="p">:</span>
                    <span class="n">conv_val</span> <span class="o">=</span> <span class="n">conv_val</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">splitter</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">dict_controllers_read</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">conv_val</span>
        <span class="k">else</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">def_val_type</span><span class="si">}</span><span class="s2"> conversion is not implemented.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dict_controllers_read</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="iris.controllers.raman_spectrometer_controller_QEPro.run_with_timeout" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_with_timeout</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Runs a function with a timeout.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to execute.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of positional arguments for the function.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of keyword arguments for the function.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timeout</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The timeout in seconds.</p>
              </div>
            </td>
            <td>
                  <code>5</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result of the function if it completes within the timeout.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="iris.utils.general.TimeoutError">TimeoutError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the function does not complete within the timeout.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/utils/general.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_with_timeout</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs a function with a timeout.</span>

<span class="sd">    Args:</span>
<span class="sd">        func: The function to execute.</span>
<span class="sd">        args: Tuple of positional arguments for the function.</span>
<span class="sd">        kwargs: Dictionary of keyword arguments for the function.</span>
<span class="sd">        timeout: The timeout in seconds.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The result of the function if it completes within the timeout.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TimeoutError: If the function does not complete within the timeout.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">exception</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">finished</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">target</span><span class="p">():</span>
        <span class="k">nonlocal</span> <span class="n">result</span><span class="p">,</span> <span class="n">exception</span>
        <span class="k">try</span><span class="p">:</span> <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span> <span class="n">exception</span> <span class="o">=</span> <span class="n">e</span>
        <span class="k">finally</span><span class="p">:</span> <span class="n">finished</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="n">timer</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">finished</span><span class="o">.</span><span class="n">set</span><span class="p">())</span>
    <span class="n">thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">)</span>

    <span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="n">finished</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
    <span class="n">timer</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">thread</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">(</span><span class="s2">&quot;Function execution timed out&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">exception</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="iris.controllers.raman_spectrometer_controller_QEPro.validator_float_greaterThanZero" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validator_float_greaterThanZero</span><span class="p">(</span><span class="n">input_str</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>A validator function that checks if the input string can be converted to a non-negative float</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_str</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input string to validate</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if valid, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>iris/utils/general.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validator_float_greaterThanZero</span><span class="p">(</span><span class="n">input_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A validator function that checks if the input string can be converted to a non-negative float</span>

<span class="sd">    Args:</span>
<span class="sd">        input_str (str): Input string to validate</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if valid, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">input_str</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">val</span> <span class="o">&gt;=</span> <span class="mf">0.0</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../..", "features": [], "search": "../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>